import subprocess

def run_vulnerability_scan(target_ip):
    command = f"omp -u admin -w admin --gvm-cache-status --scan {target_ip}"
    result = subprocess.run(command, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    return result.stdout.decode(), result.stderr.decode()

target = '192.168.1.1'
output, error = run_vulnerability_scan(target)
if error:
    print(f"An error occurred: {error}")
else:
    print(f"Scan results: {output}")
