import nmap
import logging

# Set up basic logging configuration
logging.basicConfig(filename='scan.log', level=logging.DEBUG)

def scan_network(target_ip):
    try:
        nm = nmap.PortScanner()
        # Attempting to scan the specified target IP and port range
        nm.scan(target_ip, '20-1024')
        for host in nm.all_hosts():
            print(f"Host: {host} ({nm[host].hostname()})")
            for proto in nm[host].all_protocols():
                ports = nm[host][proto].keys()
                for port in ports:
                    print(f"Port {port}: {nm[host][proto][port]['state']}")
    except Exception as e:
        logging.error(f"An error occurred: {e}")
        print("An error occurred during the scan.")

if __name__ == "__main__":
    target_ip = '192.168.1.1/24'  # Replace with your target network
    scan_network(target_ip)
