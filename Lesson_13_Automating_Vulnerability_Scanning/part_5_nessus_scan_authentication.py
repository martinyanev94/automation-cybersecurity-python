import requests

def start_nessus_scan(api_url, access_key, secret_key):
    # API endpoint to authenticate
    login_url = f"{api_url}/session"
    headers = {'Content-Type': 'application/json'}
    payload = {
        "accessKey": access_key,
        "secretKey": secret_key
    }

    # Authenticate and retrieve session token
    response = requests.post(login_url, json=payload, headers=headers)
    if response.status_code == 200:
        token = response.json()['token']
        print(f"Authenticated successfully: {token}")
    else:
        print("Failed to authenticate")

# Call the function with your Nessus API URL and keys
start_nessus_scan('https://<Nessus_IP>:8834', 'your_access_key', 'your_secret_key')
