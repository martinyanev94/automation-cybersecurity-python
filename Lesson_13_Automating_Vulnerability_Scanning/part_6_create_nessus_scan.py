def create_nessus_scan(api_url, token):
    # Creating a new scan
    scan_url = f"{api_url}/scans"
    headers = {
        'X-Cookie': f'token={token}',
        'Content-Type': 'application/json'
    }
    payload = {
        "uuid": "<scan_uuid>",  # Replace with your actual scan UUID
        "settings": {
            "name": "Automated Scan",
            "text_targets": "192.168.1.1",
            "schedule": {
                "start": "now",
                "end": "now+3600"  # Scan duration of 1 hour
            }
        }
    }

    response = requests.post(scan_url, json=payload, headers=headers)
    if response.status_code == 200:
        print("Scan created successfully.")
    else:
        print("Failed to create scan.")

# Call the function once authenticated
create_nessus_scan(api_url, token)
